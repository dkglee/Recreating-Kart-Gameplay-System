# Recreating KartRider's Gameplay System

## 프로젝트 설명
카트라이더의 핵심 시스템을 분석하고 UE5로 재구현한 연구/개발 프로젝트입니다. 
개인적으로는 **주행 감각의 재현**과 **멀티플레이 체감 품질 개선**을 목표로 했습니다.

### 대표 영상


---

## 역할 및 목표

**역할**
- 차량 물리 전반(가속, 서스펜션, 스티어링 토크, 측면 마찰/드리프트)
- 차량 네트워크(시간 동기화, 데드 레코닝)
- 부스터 게이지/부스트 동작
- 계기판 UI(HUD)
- 속도 반응형 사운드(MetaSound)

**목표**
- 카트라이더의 **주행 감각**과 **네트워크 일관성**을 UE5에서 재현
- 지연·지터 환경에서도 끊김 없는 플레이를 위해 **RTT 기반 시간 동기화 + 데드 레코닝** 적용

---

## 주요 기능

### 차량 물리
카트 특유의 탄성·그립·드리프트 감각을 다음 모델로 구현.

- **가속/저항:** 추진력·항력·롤링저항을 합력으로 계산 후 `F = m·a` 적용
- **서스펜션:** 스프링–댐퍼 `F = kx - c v`  
  바퀴별 레이캐스트로 접지점과 침하량을 추정하고 접점 위치에 힘을 가산
- **스티어링 토크:** 속도 가중 조향 토크(고속 구간에서 조향 민감도 자동 감쇄)
- **측면 마찰/드리프트:** 종·횡 속도 분해로 **Slip Angle** 추정,  
  임계각 이상에서 드리프트 상태 유지 및 드리프트 상태일 시 횡마찰 감쇠로 슬라이드 연출

**시연 영상**

https://github.com/user-attachments/assets/6394b2db-b387-4742-9bbf-1fb1c4ecae3b

**설명**
- 위의 수식들이 결합하여 위의 영상과 같은 차량 물리를 완성할 수 있었습니다.
- 언리얼의 Physics API를 사용하여 계산된 수치를 차량에 힘을 가하는 방식으로 구현하였습니다.

**소스 코드**


---

### 차량 네트워크
멀티플레이에서 위치·상태 일관성을 높이기 위한 클라이언트 기반 동기화.
- **RTT 기반 시간 동기화:**  
  클라이언트가 요청 시각을 포함해 서버 시간 요청 → 응답 수신 시  
  `ServerTime ≈ InServerTime + RTT/2`로 보정(UE 기본 방식 대비 약 **40배** 정확도 향상)
- **데드 레코닝 보간:**  
  마지막 상태로 예측 이동 후 서버 갱신 도착 시 완만 보정(스냅/워프 방지)
- **클라이언트 기반 동기화**  
  클라이언트 기반으로 물리 시뮬레이션을 돌려 Jittering(버벅이는) 현상을 없앴습니다.

**시연 영상**


**설명**
- 언리얼 엔진 5의 RPC와 Replication을 활용해 RTT 및 클라이언트 기반 시간 동기화를 구현했습니다.
- 클라이언트 기반 동기화로 물리 시뮬레이션을 로컬에서 처리해, 네트워크 지연에 따른 끊김을 줄이고 플레이어의 조작감을 개선했습니다.
- 데드 레코닝 보간을 적용해 멀티플레이 환경의 화면 불일치를 제거하고, 자기 캐릭터가 더 빠르다고 느끼는 착시를 방지했습니다.

**소스 코드**


---
